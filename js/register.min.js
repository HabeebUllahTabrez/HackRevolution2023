/* MJ Hack Revolution 2020 */
var URL="https://mjhackrevolution-v2.firebaseio.com/participants.json",registerForm=document.getElementById("register-form"),registerButton=document.getElementById("register-button"),teamNames=document.getElementById("team-names"),teamPhones=document.getElementById("team-phones"),teamName=document.getElementById("team-name"),college=document.getElementById("college"),email=document.getElementById("email"),members=document.getElementById("members");function insertData(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};fetch(URL,t).then(function(e){return e.json()}).then(function(){clearForm(),window.location.href="./success.html?s=true"}).catch(function(){clearForm(),alert("Something went wrong, Please try again later.")})}function submitHandler(e){if(e.preventDefault(),disableForm(),validateForm()){var t={};t.teamName=teamName.value,t.college=college.value,t.email=email.value,t.registeredOn=new Date(Date.now()).toString(),t.noOfMembers=+members.value,t.isCheckedIn=!1,t.isVerified=!1,t.memberNames=[],t.memberPhones=[];for(var n=1;n<=t.noOfMembers;n++)t.memberNames.push(document.getElementById("member-name-"+n).value),t.memberPhones.push(document.getElementById("member-phone-"+n).value);insertData(t)}else enableForm()}function validateForm(){for(var e=email.value.indexOf("@"),t=email.value.lastIndexOf("."),n=+members.value,r=document.getElementsByClassName("help-block"),m=0;m<r.length;m++)r.textContent="";if(""===teamName.value.trim())return document.getElementById("team-name-error").textContent=teamName.getAttribute("data-validation-required-message"),!1;if((document.getElementById("team-name-error").textContent="")===college.value.trim())return document.getElementById("college-error").textContent=college.getAttribute("data-validation-required-message"),!1;if((document.getElementById("college-error").textContent="")===email.value.trim())return document.getElementById("email-error").textContent=email.getAttribute("data-validation-required-message"),!1;if(e<1||t<e+2||t+2>=email.length)return!(document.getElementById("email-error").textContent="Enter a valid Email");if(document.getElementById("email-error").textContent="",isNaN(n))return document.getElementById("members-error").textContent=members.getAttribute("data-validation-required-message"),!1;document.getElementById("members-error").textContent="";for(m=1;m<=n;m++){if(""===document.getElementById("member-name-"+m).value.trim())return!(document.getElementById("member-name-error-"+m).textContent="Member Name is Required");if((document.getElementById("member-name-error-"+m).textContent="")===document.getElementById("member-phone-"+m).value.trim())return!(document.getElementById("member-phone-error-"+m).textContent="Phone Number is Required");if(document.getElementById("member-phone-error-"+m).textContent="",10!==document.getElementById("member-phone-"+m).value.length||!/^\d+$/.test(document.getElementById("member-phone-"+m).value))return!(document.getElementById("member-phone-error-"+m).textContent="Enter Valid Phone Number");document.getElementById("member-phone-error-"+m).textContent=""}return!0}function membersChangeHandler(e){e.preventDefault(),cleanNode(teamNames),cleanNode(teamPhones),createFormElements(+e.target.value)}function disableForm(){for(var e=document.querySelectorAll("input"),t=document.querySelector("select"),n=0;n<e.length;n++)e[n].disabled=!0;t.disabled=!0,registerButton.textContent="Submitting",registerButton.disabled=!0}function enableForm(){for(var e=document.querySelectorAll("input"),t=document.querySelector("select"),n=0;n<e.length;n++)e[n].disabled=!1;t.disabled=!1,registerButton.textContent="Submit Team Details",registerButton.disabled=!1}function clearForm(){for(var e=document.querySelectorAll("input"),t=document.querySelector("select"),n=0;n<e.length;n++)e[n].value="";t.selectedIndex=0}function createFormElements(e){for(var t=1;t<=e;t++){(m=document.createElement("div")).classList.add("form-group");var n=document.createElement("input");n.classList.add("form-control"),n.id="member-name-"+t,n.type="text",n.placeholder="Member "+t+" Name *",n.required=!0;var r=document.createElement("p");r.id="member-name-error-"+t,r.classList.add("help-block"),r.classList.add("text-danger"),m.appendChild(n),m.appendChild(r),teamNames.appendChild(m)}for(t=1;t<=e;t++){var m;(m=document.createElement("div")).classList.add("form-group");var a=document.createElement("input");a.classList.add("form-control"),a.id="member-phone-"+t,a.type="text",a.placeholder="Member "+t+" Phone *",a.required=!0;var o=document.createElement("p");o.id="member-phone-error-"+t,o.classList.add("help-block"),o.classList.add("text-danger"),m.appendChild(a),m.appendChild(o),teamPhones.appendChild(m)}}function cleanNode(e){for(;e.firstChild;)e.removeChild(e.firstChild)}registerForm.addEventListener("submit",submitHandler),members.addEventListener("change",membersChangeHandler);